var filterType,value,allHeroes=[],allItems=[],refinedItems=[],rareItems=[],isRunning=!1,openSound=new Audio("open-box.ogg"),volume=.25,weights=[],rareWeights=[],randomizedItem=[],crate=[];function pullJSON(e){allItems=[],weights=[],refinedItems=[],rareItems=[],rareWeights=[],$.ajax({url:"https://raw.githubusercontent.com/Js41637/Overwatch-Item-Tracker/development/data/master.json",dataType:"json",success:function(t){allHeroes=t.heroes,getItems(e),createWeights(refinedItems,weights),createWeights(rareItems,rareWeights)}})}function pauseCrate(){$(".generate").attr("disabled","disabled"),$(".generate").css("cursor","not-allowed")}function restoreCrate(){$(".generate").removeAttr("disabled"),$(".generate").css("cursor","pointer")}function deleteCards(){$("#crate li").remove(),$("#box").remove()}function displayCrate(){var e=chance.shuffle(crate);$.each(e,function(t){"common"==e[t].quality?value+=20:"rare"==e[t].quality?value+=40:"epic"==e[t].quality?value+=80:"legendary"==e[t].quality?value+=160:value+=20;var s=e[t].id;if(-1!==s.indexOf("wrecking-ball"))var a="wrecking ball";else a=s.substr(0,s.indexOf("-"));$("<li/>").addClass(a+" "+e[t].quality+" shadow animated bounceInDown crate-"+t).appendTo("#crate"),$("<span/>").addClass(e[t].event).appendTo(".crate-"+t),$("<p/>").text(e[t].name+" - "+a+" "+e[t].type).appendTo(".crate-"+t+" span")}),value>=280?$("#value").addClass("value--legendary"):value>=200?$("#value").addClass("value--epic"):value>=120&&$("#value").addClass("value--rare"),$("#value").text(value),isRunning=!1}function createWeights(e,t){for(var s=0;s<e.length;s++)"common"==e[s].quality?e[s].event==filterType?t.push(354):t.push(59):"rare"==e[s].quality?e[s].event==filterType?t.push(192):t.push(32):"epic"==e[s].quality?e[s].event==filterType?t.push(42):t.push(7):"legendary"==e[s].quality&&(e[s].event==filterType?t.push(12):t.push(2))}function getItems(e){"summer2016"==e?filterType="SUMMER_GAMES":"halloween"==e?filterType="HALLOWEEN":"winter"==e?filterType="WINTER_WONDERLAND":"rooster"==e?filterType="LUNAR_NEW_YEAR":"anniversary"==e?filterType="ANNIVERSARY":"uprising"==e?filterType="UPRISING":"standard"==e&&(filterType="");for(var t in allHeroes)if(allHeroes.hasOwnProperty(t)){var s=allHeroes[t].items;allHeroes[t].items.hero=t,allItems.push(s)}for(var a=0;a<allItems.length;a++){if(allItems[a].sprays)for(var l=0;l<allItems[a].sprays.length;l++)allItems[a].sprays[l].achievement||allItems[a].sprays[l].standardItem||(allItems[a].sprays[l].type="Spray",allItems[a].sprays[l].event!=filterType&&allItems[a].sprays[l].event||(refinedItems.push(allItems[a].sprays[l]),"common"!=allItems[a].sprays[l].quality&&rareItems.push(allItems[a].sprays[l])));if(allItems[a].emotes)for(l=0;l<allItems[a].emotes.length;l++)allItems[a].emotes[l].standardItem||(allItems[a].emotes[l].type="Emote",allItems[a].emotes[l].event!=filterType&&allItems[a].emotes[l].event||(refinedItems.push(allItems[a].emotes[l]),"common"!=allItems[a].emotes[l].quality&&rareItems.push(allItems[a].emotes[l])));if(allItems[a].intros)for(l=0;l<allItems[a].intros.length;l++)allItems[a].intros[l].standardItem||(allItems[a].intros[l].type="Intro",allItems[a].intros[l].event!=filterType&&allItems[a].intros[l].event||(refinedItems.push(allItems[a].intros[l]),"common"!=allItems[a].intros[l].quality&&rareItems.push(allItems[a].intros[l])));if(allItems[a].poses)for(l=0;l<allItems[a].poses.length;l++)allItems[a].poses[l].standardItem||(allItems[a].poses[l].type="Victory Pose",allItems[a].poses[l].event!=filterType&&allItems[a].poses[l].event||(refinedItems.push(allItems[a].poses[l]),"common"!=allItems[a].poses[l].quality&&rareItems.push(allItems[a].poses[l])));if(allItems[a].skins)for(l=0;l<allItems[a].skins.length;l++)allItems[a].skins[l].standardItem||(allItems[a].skins[l].type="Skin",allItems[a].skins[l].event!=filterType&&allItems[a].skins[l].event||(refinedItems.push(allItems[a].skins[l]),"common"!=allItems[a].skins[l].quality&&rareItems.push(allItems[a].skins[l])));if(allItems[a].voicelines)for(l=0;l<allItems[a].voicelines.length;l++)allItems[a].voicelines[l].standardItem||(allItems[a].voicelines[l].type="Voiceline",allItems[a].voicelines[l].event!=filterType&&allItems[a].voicelines[l].event||(refinedItems.push(allItems[a].voicelines[l]),"common"!=allItems[a].voicelines[l].quality&&rareItems.push(allItems[a].voicelines[l])))}}$.fn.extend({animateCss:function(e){$(this).addClass("animated "+e).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).removeClass("animated "+e)})}}),$(document).ready(function(){pullJSON("standard")}),$(".js-volume").click(function(){$(this).hasClass("is-on")?($(this).text("volume_off").removeClass("is-on").addClass("is-off"),openSound.muted=!0):($(this).text("volume_up").removeClass("is-off").addClass("is-on"),openSound.muted=!1)}),$(".generate").click(function(){if(0==isRunning){for($("#value").text("0").removeClass(),pauseCrate(),isRunning=!0,crate=[],value=0,openSound.volume=volume,openSound.play(),$("#box, .crate-0, .crate-1, .crate-2, .crate-3").animateCss("bounceOutUp"),setTimeout(deleteCards,950),i=0;i<3;i++)randomizedItem=chance.weighted(refinedItems,weights),crate.push(randomizedItem);randomizedItem=chance.weighted(rareItems,rareWeights),crate.push(randomizedItem),setTimeout(displayCrate,2350),setTimeout(restoreCrate,4e3)}}),$(".box-type ul li a").click(function(){$(".box-type ul li a").removeClass("active"),$(this).addClass("active"),pullJSON($(this).attr("id"))});